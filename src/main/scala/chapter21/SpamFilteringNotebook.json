{"paragraphs":[{"text":"import org.apache.spark.sql.types.{ StructType, StructField, StringType }\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.{ SparkSession, Row }\nimport org.apache.spark.sql.functions.udf\nimport java.util.regex.Pattern\nimport org.apache.spark.sql.functions.{ lower, upper }\nimport org.apache.log4j.{ Level, Logger }\nimport org.apache.spark.ml.classification.LogisticRegression\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.mllib.evaluation.MulticlassMetrics\nimport org.apache.spark.sql.types._","user":"anonymous","dateUpdated":"2017-04-23T08:15:30-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.types.{StructType, StructField, StringType}\n\nimport org.apache.spark.rdd.RDD\n\nimport org.apache.spark.sql.{SparkSession, Row}\n\nimport org.apache.spark.sql.functions.udf\n\nimport java.util.regex.Pattern\n\nimport org.apache.spark.sql.functions.{lower, upper}\n\nimport org.apache.log4j.{Level, Logger}\n\nimport org.apache.spark.ml.classification.LogisticRegression\n\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\nimport org.apache.spark.ml.feature._\n\nimport org.apache.spark.mllib.evaluation.MulticlassMetrics\n\nimport org.apache.spark.sql.types._\n"}]},"apps":[],"jobName":"paragraph_1492959505096_140631093","id":"20170423-075825_256628020","dateCreated":"2017-04-23T07:58:25-0700","dateStarted":"2017-04-23T08:15:30-0700","dateFinished":"2017-04-23T08:15:44-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:592"},{"text":"  val customSchema = StructType(Array(\n    StructField(\"RawLabel\", StringType, true),\n    StructField(\"SmsText\", StringType, true)))\n","user":"anonymous","dateUpdated":"2017-04-23T09:54:58-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ncustomSchema: org.apache.spark.sql.types.StructType = StructType(StructField(RawLabel,StringType,true), StructField(SmsText,StringType,true))\n"}]},"apps":[],"jobName":"paragraph_1492959536939_-701923026","id":"20170423-075856_1780970776","dateCreated":"2017-04-23T07:58:56-0700","dateStarted":"2017-04-23T09:54:58-0700","dateFinished":"2017-04-23T09:54:58-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:593"},{"text":"    val data = spark.read.format(\"com.databricks.spark.csv\")\n                         .option(\"inferSchema\", \"false\")\n                         .option(\"delimiter\", \"\\t\").\n                         schema(customSchema).load(\"/home/asif/data/SMSSpamCollection\")\n    data.show()","user":"anonymous","dateUpdated":"2017-04-23T09:55:02-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndata: org.apache.spark.sql.DataFrame = [RawLabel: string, SmsText: string]\n+--------+--------------------+\n|RawLabel|             SmsText|\n+--------+--------------------+\n|     ham|Go until jurong p...|\n|     ham|Ok lar... Joking ...|\n|    spam|Free entry in 2 a...|\n|     ham|U dun say so earl...|\n|     ham|Nah I don't think...|\n|    spam|FreeMsg Hey there...|\n|     ham|Even my brother i...|\n|     ham|As per your reque...|\n|    spam|WINNER!! As a val...|\n|    spam|Had your mobile 1...|\n|     ham|I'm gonna be home...|\n|    spam|SIX chances to wi...|\n|    spam|URGENT! You have ...|\n|     ham|I've been searchi...|\n|     ham|I HAVE A DATE ON ...|\n|    spam|XXXMobileMovieClu...|\n|     ham|Oh k...i'm watchi...|\n|     ham|Eh u remember how...|\n|     ham|Fine if thats th...|\n|    spam|England v Macedon...|\n+--------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1492959677659_405166481","id":"20170423-080117_792771511","dateCreated":"2017-04-23T08:01:17-0700","dateStarted":"2017-04-23T09:55:02-0700","dateFinished":"2017-04-23T09:55:03-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:594"},{"text":"    import spark.implicits._\n    import org.apache.spark.sql.functions.count\n    import org.apache.spark.sql.functions.col","user":"anonymous","dateUpdated":"2017-04-23T08:16:08-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions.count\n\nimport org.apache.spark.sql.functions.col\n"}]},"apps":[],"jobName":"paragraph_1492959712653_475437612","id":"20170423-080152_1235395377","dateCreated":"2017-04-23T08:01:52-0700","dateStarted":"2017-04-23T08:16:08-0700","dateFinished":"2017-04-23T08:16:09-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:595"},{"text":"    // string indexer\n    val indexer = new StringIndexer()\n      .setInputCol(\"RawLabel\")\n      .setOutputCol(\"label\")\n    val indexed = indexer.fit(data).transform(data)\n    indexed.show()","user":"anonymous","dateUpdated":"2017-04-23T09:55:22-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nindexer: org.apache.spark.ml.feature.StringIndexer = strIdx_b5f32ee61ef9\n\nindexed: org.apache.spark.sql.DataFrame = [RawLabel: string, SmsText: string ... 1 more field]\n+--------+--------------------+-----+\n|RawLabel|             SmsText|label|\n+--------+--------------------+-----+\n|     ham|Go until jurong p...|  0.0|\n|     ham|Ok lar... Joking ...|  0.0|\n|    spam|Free entry in 2 a...|  1.0|\n|     ham|U dun say so earl...|  0.0|\n|     ham|Nah I don't think...|  0.0|\n|    spam|FreeMsg Hey there...|  1.0|\n|     ham|Even my brother i...|  0.0|\n|     ham|As per your reque...|  0.0|\n|    spam|WINNER!! As a val...|  1.0|\n|    spam|Had your mobile 1...|  1.0|\n|     ham|I'm gonna be home...|  0.0|\n|    spam|SIX chances to wi...|  1.0|\n|    spam|URGENT! You have ...|  1.0|\n|     ham|I've been searchi...|  0.0|\n|     ham|I HAVE A DATE ON ...|  0.0|\n|    spam|XXXMobileMovieClu...|  1.0|\n|     ham|Oh k...i'm watchi...|  0.0|\n|     ham|Eh u remember how...|  0.0|\n|     ham|Fine if thats th...|  0.0|\n|    spam|England v Macedon...|  1.0|\n+--------+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1492959750912_1260771414","id":"20170423-080230_1790892573","dateCreated":"2017-04-23T08:02:30-0700","dateStarted":"2017-04-23T09:55:22-0700","dateFinished":"2017-04-23T09:55:22-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:596"},{"text":"    val regexTokenizer = new RegexTokenizer()\n      .setInputCol(\"SmsText\")\n      .setOutputCol(\"words\")\n      .setPattern(\"\\\\d\")\n      .setPattern(\"\\\\W+\")\n      .setGaps(true)\n\n    val countTokens = udf { (words: Seq[String]) => words.length }\n    val regexTokenized = regexTokenizer.transform(indexed)\n    regexTokenized.show()","user":"anonymous","dateUpdated":"2017-04-23T10:01:12-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nregexTokenizer: org.apache.spark.ml.feature.RegexTokenizer = regexTok_720a32bf1429\n\ncountTokens: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,IntegerType,Some(List(ArrayType(StringType,true))))\n\nregexTokenized: org.apache.spark.sql.DataFrame = [RawLabel: string, SmsText: string ... 2 more fields]\n+--------+--------------------+-----+--------------------+\n|RawLabel|             SmsText|label|               words|\n+--------+--------------------+-----+--------------------+\n|     ham|Go until jurong p...|  0.0|[go, until, juron...|\n|     ham|Ok lar... Joking ...|  0.0|[ok, lar, joking,...|\n|    spam|Free entry in 2 a...|  1.0|[free, entry, in,...|\n|     ham|U dun say so earl...|  0.0|[u, dun, say, so,...|\n|     ham|Nah I don't think...|  0.0|[nah, i, don, t, ...|\n|    spam|FreeMsg Hey there...|  1.0|[freemsg, hey, th...|\n|     ham|Even my brother i...|  0.0|[even, my, brothe...|\n|     ham|As per your reque...|  0.0|[as, per, your, r...|\n|    spam|WINNER!! As a val...|  1.0|[winner, as, a, v...|\n|    spam|Had your mobile 1...|  1.0|[had, your, mobil...|\n|     ham|I'm gonna be home...|  0.0|[i, m, gonna, be,...|\n|    spam|SIX chances to wi...|  1.0|[six, chances, to...|\n|    spam|URGENT! You have ...|  1.0|[urgent, you, hav...|\n|     ham|I've been searchi...|  0.0|[i, ve, been, sea...|\n|     ham|I HAVE A DATE ON ...|  0.0|[i, have, a, date...|\n|    spam|XXXMobileMovieClu...|  1.0|[xxxmobilemoviecl...|\n|     ham|Oh k...i'm watchi...|  0.0|[oh, k, i, m, wat...|\n|     ham|Eh u remember how...|  0.0|[eh, u, remember,...|\n|     ham|Fine if thats th...|  0.0|[fine, if, that, ...|\n|    spam|England v Macedon...|  1.0|[england, v, mace...|\n+--------+--------------------+-----+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1492959766406_1303710049","id":"20170423-080246_1473927957","dateCreated":"2017-04-23T08:02:46-0700","dateStarted":"2017-04-23T10:01:12-0700","dateFinished":"2017-04-23T10:01:13-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:597"},{"text":"    val remover = new StopWordsRemover()\n      .setInputCol(\"words\")\n      .setOutputCol(\"filtered\")\n\n    val tokenDF = remover.transform(regexTokenized)\n    tokenDF.show()","user":"anonymous","dateUpdated":"2017-04-23T10:24:40-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nremover: org.apache.spark.ml.feature.StopWordsRemover = stopWords_33fe2c039849\n\ntokenDF: org.apache.spark.sql.DataFrame = [RawLabel: string, SmsText: string ... 3 more fields]\n+--------+--------------------+-----+--------------------+--------------------+\n|RawLabel|             SmsText|label|               words|            filtered|\n+--------+--------------------+-----+--------------------+--------------------+\n|     ham|Go until jurong p...|  0.0|[go, until, juron...|[go, jurong, poin...|\n|     ham|Ok lar... Joking ...|  0.0|[ok, lar, joking,...|[ok, lar, joking,...|\n|    spam|Free entry in 2 a...|  1.0|[free, entry, in,...|[free, entry, 2, ...|\n|     ham|U dun say so earl...|  0.0|[u, dun, say, so,...|[u, dun, say, ear...|\n|     ham|Nah I don't think...|  0.0|[nah, i, don, t, ...|[nah, think, goes...|\n|    spam|FreeMsg Hey there...|  1.0|[freemsg, hey, th...|[freemsg, hey, da...|\n|     ham|Even my brother i...|  0.0|[even, my, brothe...|[even, brother, l...|\n|     ham|As per your reque...|  0.0|[as, per, your, r...|[per, request, me...|\n|    spam|WINNER!! As a val...|  1.0|[winner, as, a, v...|[winner, valued, ...|\n|    spam|Had your mobile 1...|  1.0|[had, your, mobil...|[mobile, 11, mont...|\n|     ham|I'm gonna be home...|  0.0|[i, m, gonna, be,...|[gonna, home, soo...|\n|    spam|SIX chances to wi...|  1.0|[six, chances, to...|[six, chances, wi...|\n|    spam|URGENT! You have ...|  1.0|[urgent, you, hav...|[urgent, 1, week,...|\n|     ham|I've been searchi...|  0.0|[i, ve, been, sea...|[searching, right...|\n|     ham|I HAVE A DATE ON ...|  0.0|[i, have, a, date...|      [date, sunday]|\n|    spam|XXXMobileMovieClu...|  1.0|[xxxmobilemoviecl...|[xxxmobilemoviecl...|\n|     ham|Oh k...i'm watchi...|  0.0|[oh, k, i, m, wat...|   [oh, k, watching]|\n|     ham|Eh u remember how...|  0.0|[eh, u, remember,...|[eh, u, remember,...|\n|     ham|Fine if thats th...|  0.0|[fine, if, that, ...|[fine, way, u, fe...|\n|    spam|England v Macedon...|  1.0|[england, v, mace...|[england, v, mace...|\n+--------+--------------------+-----+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1492959787299_-2105549955","id":"20170423-080307_2042320210","dateCreated":"2017-04-23T08:03:07-0700","dateStarted":"2017-04-23T10:24:40-0700","dateFinished":"2017-04-23T10:24:41-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:598"},{"text":"    val spamTokensWithFrequenciesDF = tokenDF\n      .filter($\"label\" === 1.0)\n      .select($\"filtered\")\n      .flatMap(row => row.getAs[Seq[String]](0))\n      .filter(word => (word.length() > 1))\n      .toDF(\"Tokens\")\n      .groupBy($\"Tokens\")\n      .agg(count(\"*\").as(\"Frequency\"))\n      .orderBy($\"Frequency\".desc)\n\n    spamTokensWithFrequenciesDF.createOrReplaceTempView(\"spamTokensWithFrequenciesDF\")\n    spamTokensWithFrequenciesDF.show()","user":"anonymous","dateUpdated":"2017-04-23T10:24:57-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nspamTokensWithFrequenciesDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Tokens: string, Frequency: bigint]\n+------+---------+\n|Tokens|Frequency|\n+------+---------+\n|  call|      355|\n|  free|      224|\n|   txt|      163|\n|    ur|      144|\n|mobile|      127|\n|  text|      125|\n|  stop|      123|\n| claim|      113|\n| reply|      104|\n|   www|       98|\n| prize|       93|\n|   get|       86|\n|  cash|       76|\n|    uk|       74|\n|  send|       71|\n|  150p|       71|\n|   new|       69|\n| nokia|       67|\n|   win|       64|\n|urgent|       63|\n+------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1492959818657_1530388448","id":"20170423-080338_678676672","dateCreated":"2017-04-23T08:03:38-0700","dateStarted":"2017-04-23T10:24:57-0700","dateFinished":"2017-04-23T10:24:58-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:599"},{"text":"%sql select * from spamTokensWithFrequenciesDF where Frequency >= 10 order by Frequency desc limit ${wordLimit}","user":"anonymous","dateUpdated":"2017-04-23T10:16:41-0700","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":true,"setting":{"scatterChart":{}}},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{"wordLimit":"100"},"forms":{"wordLimit":{"name":"wordLimit","defaultValue":"","hidden":false,"$$hashKey":"object:5469"}}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Tokens\tFrequency\ncall\t355\nfree\t224\ntxt\t163\nur\t144\nmobile\t127\ntext\t125\nstop\t123\nclaim\t113\nreply\t104\nwww\t98\nprize\t93\nget\t86\ncash\t76\nuk\t74\nsend\t71\n150p\t71\nnew\t69\nnokia\t67\nwin\t64\nurgent\t63\nweek\t60\ntone\t60\n50\t57\nservice\t56\ncontact\t56\nplease\t55\ncom\t54\nmsg\t54\nco\t54\n16\t53\n18\t51\nguaranteed\t50\ncustomer\t49\nper\t46\nphone\t45\n500\t44\nchat\t44\ncs\t44\nmin\t43\n1000\t41\n100\t40\ndraw\t39\nawarded\t38\nmins\t36\nsms\t36\nlatest\t36\nline\t35\ncamera\t35\nmessage\t34\n150ppm\t34\nbox\t33\nevery\t33\nreceive\t33\nwk\t32\nlandline\t32\nringtone\t32\nholiday\t32\nvideo\t32\npo\t32\ngo\t31\ncost\t31\nfind\t31\nshows\t31\napply\t30\nrate\t30\nwant\t30\ncode\t30\nnumber\t30\nlive\t29\n000\t29\naward\t28\n10\t27\nchance\t27\noffer\t27\norange\t27\ntones\t26\nentry\t26\n1st\t26\ncollection\t26\nselected\t25\nnetwork\t25\nword\t25\n5000\t25\nknow\t25\nmob\t25\n10p\t24\nvalid\t24\n2000\t24\nweekly\t24\nback\t23\ncollect\t23\nattempt\t22\nnational\t22\nhelp\t22\n800\t22\ntoday\t21\nhttp\t21\n8007\t21\nmusic\t21\nvouchers\t21\n"}]},"apps":[],"jobName":"paragraph_1492959834507_-1381175045","id":"20170423-080354_204792320","dateCreated":"2017-04-23T08:03:54-0700","dateStarted":"2017-04-23T10:16:41-0700","dateFinished":"2017-04-23T10:16:42-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:600"},{"text":"val hamTokensWithFrequenciesDF = tokenDF\n      .filter($\"label\" === 0.0)\n      .select($\"filtered\")\n      .flatMap(row => row.getAs[Seq[String]](0))\n      .filter(word => (word.length() > 1))\n      .toDF(\"Tokens\")\n      .groupBy($\"Tokens\")\n      .agg(count(\"*\").as(\"Frequency\"))\n      .orderBy($\"Frequency\".desc)\n      \n      \n\n    hamTokensWithFrequenciesDF.createOrReplaceTempView(\"hamTokensWithFrequenciesDF\")\n    hamTokensWithFrequenciesDF.show()\n","user":"anonymous","dateUpdated":"2017-04-23T10:20:10-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492959874679_-1516545361","id":"20170423-080434_199455486","dateCreated":"2017-04-23T08:04:34-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:601","dateFinished":"2017-04-23T10:20:11-0700","dateStarted":"2017-04-23T10:20:10-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nhamTokensWithFrequenciesDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Tokens: string, Frequency: bigint]\n+------+---------+\n|Tokens|Frequency|\n+------+---------+\n|    gt|      318|\n|    lt|      316|\n|   get|      305|\n|    ok|      288|\n|    go|      252|\n|    ur|      247|\n|  call|      238|\n|  know|      237|\n|  good|      235|\n|  like|      234|\n|   got|      233|\n|  come|      230|\n|   day|      212|\n|  love|      205|\n|  time|      202|\n| going|      169|\n|   one|      168|\n|  want|      165|\n|  home|      165|\n|   lor|      162|\n+------+---------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{"wordLimit":"15"},"forms":{"wordLimit":{"name":"wordLimit","defaultValue":"","hidden":false,"$$hashKey":"object:2574"}}},"apps":[],"jobName":"paragraph_1492960957728_-236199021","id":"20170423-082237_1812682050","dateCreated":"2017-04-23T08:22:37-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1994","text":"%sql select * from hamTokensWithFrequenciesDF order by Frequency desc limit ${wordLimit}","dateUpdated":"2017-04-23T08:25:21-0700","dateFinished":"2017-04-23T08:25:23-0700","dateStarted":"2017-04-23T08:25:21-0700","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Tokens\tFrequency\ngt\t318\nlt\t316\nget\t305\nok\t288\ngo\t252\nur\t247\ncall\t238\nknow\t237\ngood\t235\nlike\t234\ngot\t233\ncome\t230\nday\t212\nlove\t205\ntime\t202\n"}]}},{"text":"    val hashingTF = new HashingTF()\n      .setInputCol(\"filtered\")\n      .setOutputCol(\"tf\")\n    val tfdata = hashingTF.transform(tokenDF)\n\n    tfdata.show()\n","user":"anonymous","dateUpdated":"2017-04-23T10:27:29-0700","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492961028368_-23509500","id":"20170423-082348_848627132","dateCreated":"2017-04-23T08:23:48-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2130","dateFinished":"2017-04-23T10:27:30-0700","dateStarted":"2017-04-23T10:27:29-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nhashingTF: org.apache.spark.ml.feature.HashingTF = hashingTF_00e0ac9e2360\n\ntfdata: org.apache.spark.sql.DataFrame = [RawLabel: string, SmsText: string ... 4 more fields]\n+--------+--------------------+-----+--------------------+--------------------+--------------------+\n|RawLabel|             SmsText|label|               words|            filtered|                  tf|\n+--------+--------------------+-----+--------------------+--------------------+--------------------+\n|     ham|Go until jurong p...|  0.0|[go, until, juron...|[go, jurong, poin...|(262144,[17222,26...|\n|     ham|Ok lar... Joking ...|  0.0|[ok, lar, joking,...|[ok, lar, joking,...|(262144,[122516,1...|\n|    spam|Free entry in 2 a...|  1.0|[free, entry, in,...|[free, entry, 2, ...|(262144,[7958,122...|\n|     ham|U dun say so earl...|  0.0|[u, dun, say, so,...|[u, dun, say, ear...|(262144,[28698,35...|\n|     ham|Nah I don't think...|  0.0|[nah, i, don, t, ...|[nah, think, goes...|(262144,[2710,259...|\n|    spam|FreeMsg Hey there...|  1.0|[freemsg, hey, th...|[freemsg, hey, da...|(262144,[8443,240...|\n|     ham|Even my brother i...|  0.0|[even, my, brothe...|[even, brother, l...|(262144,[2089,497...|\n|     ham|As per your reque...|  0.0|[as, per, your, r...|[per, request, me...|(262144,[38868,53...|\n|    spam|WINNER!! As a val...|  1.0|[winner, as, a, v...|[winner, valued, ...|(262144,[34651,43...|\n|    spam|Had your mobile 1...|  1.0|[had, your, mobil...|[mobile, 11, mont...|(262144,[10951,40...|\n|     ham|I'm gonna be home...|  0.0|[i, m, gonna, be,...|[gonna, home, soo...|(262144,[6258,178...|\n|    spam|SIX chances to wi...|  1.0|[six, chances, to...|[six, chances, wi...|(262144,[7958,139...|\n|    spam|URGENT! You have ...|  1.0|[urgent, you, hav...|[urgent, 1, week,...|(262144,[7958,238...|\n|     ham|I've been searchi...|  0.0|[i, ve, been, sea...|[searching, right...|(262144,[55639,71...|\n|     ham|I HAVE A DATE ON ...|  0.0|[i, have, a, date...|      [date, sunday]|(262144,[81948,13...|\n|    spam|XXXMobileMovieClu...|  1.0|[xxxmobilemoviecl...|[xxxmobilemoviecl...|(262144,[66,7958,...|\n|     ham|Oh k...i'm watchi...|  0.0|[oh, k, i, m, wat...|   [oh, k, watching]|(262144,[63139,11...|\n|     ham|Eh u remember how...|  0.0|[eh, u, remember,...|[eh, u, remember,...|(262144,[739,3511...|\n|     ham|Fine if thats th...|  0.0|[fine, if, that, ...|[fine, way, u, fe...|(262144,[30913,61...|\n|    spam|England v Macedon...|  1.0|[england, v, mace...|[england, v, mace...|(262144,[7958,415...|\n+--------+--------------------+-----+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492968068973_-962649870","id":"20170423-102108_1088770555","dateCreated":"2017-04-23T10:21:08-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5606","text":"    val idf = new IDF().setInputCol(\"tf\").setOutputCol(\"idf\")\n    val idfModel = idf.fit(tfdata)\n    val idfdata = idfModel.transform(tfdata)\n    idfdata.show()","dateUpdated":"2017-04-23T10:32:00-0700","dateFinished":"2017-04-23T10:32:02-0700","dateStarted":"2017-04-23T10:32:00-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nidf: org.apache.spark.ml.feature.IDF = idf_32395389c640\n\nidfModel: org.apache.spark.ml.feature.IDFModel = idf_32395389c640\n\nidfdata: org.apache.spark.sql.DataFrame = [RawLabel: string, SmsText: string ... 5 more fields]\n+--------+--------------------+-----+--------------------+--------------------+--------------------+--------------------+\n|RawLabel|             SmsText|label|               words|            filtered|                  tf|                 idf|\n+--------+--------------------+-----+--------------------+--------------------+--------------------+--------------------+\n|     ham|Go until jurong p...|  0.0|[go, until, juron...|[go, jurong, poin...|(262144,[17222,26...|(262144,[17222,26...|\n|     ham|Ok lar... Joking ...|  0.0|[ok, lar, joking,...|[ok, lar, joking,...|(262144,[122516,1...|(262144,[122516,1...|\n|    spam|Free entry in 2 a...|  1.0|[free, entry, in,...|[free, entry, 2, ...|(262144,[7958,122...|(262144,[7958,122...|\n|     ham|U dun say so earl...|  0.0|[u, dun, say, so,...|[u, dun, say, ear...|(262144,[28698,35...|(262144,[28698,35...|\n|     ham|Nah I don't think...|  0.0|[nah, i, don, t, ...|[nah, think, goes...|(262144,[2710,259...|(262144,[2710,259...|\n|    spam|FreeMsg Hey there...|  1.0|[freemsg, hey, th...|[freemsg, hey, da...|(262144,[8443,240...|(262144,[8443,240...|\n|     ham|Even my brother i...|  0.0|[even, my, brothe...|[even, brother, l...|(262144,[2089,497...|(262144,[2089,497...|\n|     ham|As per your reque...|  0.0|[as, per, your, r...|[per, request, me...|(262144,[38868,53...|(262144,[38868,53...|\n|    spam|WINNER!! As a val...|  1.0|[winner, as, a, v...|[winner, valued, ...|(262144,[34651,43...|(262144,[34651,43...|\n|    spam|Had your mobile 1...|  1.0|[had, your, mobil...|[mobile, 11, mont...|(262144,[10951,40...|(262144,[10951,40...|\n|     ham|I'm gonna be home...|  0.0|[i, m, gonna, be,...|[gonna, home, soo...|(262144,[6258,178...|(262144,[6258,178...|\n|    spam|SIX chances to wi...|  1.0|[six, chances, to...|[six, chances, wi...|(262144,[7958,139...|(262144,[7958,139...|\n|    spam|URGENT! You have ...|  1.0|[urgent, you, hav...|[urgent, 1, week,...|(262144,[7958,238...|(262144,[7958,238...|\n|     ham|I've been searchi...|  0.0|[i, ve, been, sea...|[searching, right...|(262144,[55639,71...|(262144,[55639,71...|\n|     ham|I HAVE A DATE ON ...|  0.0|[i, have, a, date...|      [date, sunday]|(262144,[81948,13...|(262144,[81948,13...|\n|    spam|XXXMobileMovieClu...|  1.0|[xxxmobilemoviecl...|[xxxmobilemoviecl...|(262144,[66,7958,...|(262144,[66,7958,...|\n|     ham|Oh k...i'm watchi...|  0.0|[oh, k, i, m, wat...|   [oh, k, watching]|(262144,[63139,11...|(262144,[63139,11...|\n|     ham|Eh u remember how...|  0.0|[eh, u, remember,...|[eh, u, remember,...|(262144,[739,3511...|(262144,[739,3511...|\n|     ham|Fine if thats th...|  0.0|[fine, if, that, ...|[fine, way, u, fe...|(262144,[30913,61...|(262144,[30913,61...|\n|    spam|England v Macedon...|  1.0|[england, v, mace...|[england, v, mace...|(262144,[7958,415...|(262144,[7958,415...|\n+--------+--------------------+-----+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492968720362_842758891","id":"20170423-103200_27024400","dateCreated":"2017-04-23T10:32:00-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5808","text":"    val assembler = new VectorAssembler()\n      .setInputCols(Array(\"idf\"))\n      .setOutputCol(\"features\")\n    val assemDF = assembler.transform(idfdata)\n    assemDF.show()","dateUpdated":"2017-04-23T10:33:43-0700","dateFinished":"2017-04-23T10:33:45-0700","dateStarted":"2017-04-23T10:33:43-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_44bf432fd1e6\n\nassemDF: org.apache.spark.sql.DataFrame = [RawLabel: string, SmsText: string ... 6 more fields]\n+--------+--------------------+-----+--------------------+--------------------+--------------------+--------------------+--------------------+\n|RawLabel|             SmsText|label|               words|            filtered|                  tf|                 idf|            features|\n+--------+--------------------+-----+--------------------+--------------------+--------------------+--------------------+--------------------+\n|     ham|Go until jurong p...|  0.0|[go, until, juron...|[go, jurong, poin...|(262144,[17222,26...|(262144,[17222,26...|(262144,[17222,26...|\n|     ham|Ok lar... Joking ...|  0.0|[ok, lar, joking,...|[ok, lar, joking,...|(262144,[122516,1...|(262144,[122516,1...|(262144,[122516,1...|\n|    spam|Free entry in 2 a...|  1.0|[free, entry, in,...|[free, entry, 2, ...|(262144,[7958,122...|(262144,[7958,122...|(262144,[7958,122...|\n|     ham|U dun say so earl...|  0.0|[u, dun, say, so,...|[u, dun, say, ear...|(262144,[28698,35...|(262144,[28698,35...|(262144,[28698,35...|\n|     ham|Nah I don't think...|  0.0|[nah, i, don, t, ...|[nah, think, goes...|(262144,[2710,259...|(262144,[2710,259...|(262144,[2710,259...|\n|    spam|FreeMsg Hey there...|  1.0|[freemsg, hey, th...|[freemsg, hey, da...|(262144,[8443,240...|(262144,[8443,240...|(262144,[8443,240...|\n|     ham|Even my brother i...|  0.0|[even, my, brothe...|[even, brother, l...|(262144,[2089,497...|(262144,[2089,497...|(262144,[2089,497...|\n|     ham|As per your reque...|  0.0|[as, per, your, r...|[per, request, me...|(262144,[38868,53...|(262144,[38868,53...|(262144,[38868,53...|\n|    spam|WINNER!! As a val...|  1.0|[winner, as, a, v...|[winner, valued, ...|(262144,[34651,43...|(262144,[34651,43...|(262144,[34651,43...|\n|    spam|Had your mobile 1...|  1.0|[had, your, mobil...|[mobile, 11, mont...|(262144,[10951,40...|(262144,[10951,40...|(262144,[10951,40...|\n|     ham|I'm gonna be home...|  0.0|[i, m, gonna, be,...|[gonna, home, soo...|(262144,[6258,178...|(262144,[6258,178...|(262144,[6258,178...|\n|    spam|SIX chances to wi...|  1.0|[six, chances, to...|[six, chances, wi...|(262144,[7958,139...|(262144,[7958,139...|(262144,[7958,139...|\n|    spam|URGENT! You have ...|  1.0|[urgent, you, hav...|[urgent, 1, week,...|(262144,[7958,238...|(262144,[7958,238...|(262144,[7958,238...|\n|     ham|I've been searchi...|  0.0|[i, ve, been, sea...|[searching, right...|(262144,[55639,71...|(262144,[55639,71...|(262144,[55639,71...|\n|     ham|I HAVE A DATE ON ...|  0.0|[i, have, a, date...|      [date, sunday]|(262144,[81948,13...|(262144,[81948,13...|(262144,[81948,13...|\n|    spam|XXXMobileMovieClu...|  1.0|[xxxmobilemoviecl...|[xxxmobilemoviecl...|(262144,[66,7958,...|(262144,[66,7958,...|(262144,[66,7958,...|\n|     ham|Oh k...i'm watchi...|  0.0|[oh, k, i, m, wat...|   [oh, k, watching]|(262144,[63139,11...|(262144,[63139,11...|(262144,[63139,11...|\n|     ham|Eh u remember how...|  0.0|[eh, u, remember,...|[eh, u, remember,...|(262144,[739,3511...|(262144,[739,3511...|(262144,[739,3511...|\n|     ham|Fine if thats th...|  0.0|[fine, if, that, ...|[fine, way, u, fe...|(262144,[30913,61...|(262144,[30913,61...|(262144,[30913,61...|\n|    spam|England v Macedon...|  1.0|[england, v, mace...|[england, v, mace...|(262144,[7958,415...|(262144,[7958,415...|(262144,[7958,415...|\n+--------+--------------------+-----+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492968823484_-1430444356","id":"20170423-103343_2018873867","dateCreated":"2017-04-23T10:33:43-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5892","text":"    //Preparing the DataFrame to traing the ML model takes only two columns such as label and features\n    val mlDF = assemDF.select(\"label\", \"features\")\n    // split\n    val Array(trainingData, testData) = mlDF.randomSplit(Array(0.75, 0.25), 12345L)","dateUpdated":"2017-04-23T10:42:29-0700","dateFinished":"2017-04-23T10:42:30-0700","dateStarted":"2017-04-23T10:42:29-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nmlDF: org.apache.spark.sql.DataFrame = [label: double, features: vector]\n\n\ntrainingData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [label: double, features: vector]\ntestData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [label: double, features: vector]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492969349726_1727171254","id":"20170423-104229_435081521","dateCreated":"2017-04-23T10:42:29-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5976","text":"val lr = new LogisticRegression()\n      .setLabelCol(\"label\")\n      .setFeaturesCol(\"features\")\n      .setRegParam(0.0001)\n      .setElasticNetParam(0.0001)\n      .setMaxIter(200)\nval lrModel = lr.fit(trainingData)","dateUpdated":"2017-04-23T10:44:18-0700","dateFinished":"2017-04-23T10:47:06-0700","dateStarted":"2017-04-23T10:44:18-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nlr: org.apache.spark.ml.classification.LogisticRegression = logreg_1b639fbdf316\n\nlrModel: org.apache.spark.ml.classification.LogisticRegressionModel = logreg_1b639fbdf316\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492969458337_-1965109054","id":"20170423-104418_1469410462","dateCreated":"2017-04-23T10:44:18-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6060","text":" // predict\n    val predict = lrModel.transform(testData)\n    predict.show(100)\n    // evaluate\n    val evaluator = new BinaryClassificationEvaluator()\n      .setRawPredictionCol(\"prediction\")","dateUpdated":"2017-04-23T10:51:49-0700","dateFinished":"2017-04-23T10:51:52-0700","dateStarted":"2017-04-23T10:51:49-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npredict: org.apache.spark.sql.DataFrame = [label: double, features: vector ... 3 more fields]\n+-----+--------------------+--------------------+--------------------+----------+\n|label|            features|       rawPrediction|         probability|prediction|\n+-----+--------------------+--------------------+--------------------+----------+\n|  0.0|      (262144,[],[])|[9.84946747585520...|[0.99994722749543...|       0.0|\n|  0.0|(262144,[1,1232,2...|[10.0013808403117...|[0.99995466477240...|       0.0|\n|  0.0|(262144,[10,9079,...|[9.77597275852494...|[0.99994320314235...|       0.0|\n|  0.0|(262144,[14,571,9...|[13.9225090128931...|[0.99999910147374...|       0.0|\n|  0.0|(262144,[14,666,2...|[10.6197536390013...|[0.99997557193953...|       0.0|\n|  0.0|(262144,[14,991,1...|[12.9168072978865...|[0.99999754359032...|       0.0|\n|  0.0|(262144,[14,13957...|[10.5912073602959...|[0.99997486457861...|       0.0|\n|  0.0|(262144,[14,17222...|[10.7305769262044...|[0.99997813446252...|       0.0|\n|  0.0|(262144,[14,17827...|[9.00173417121605...|[0.99987681919956...|       0.0|\n|  0.0|(262144,[14,22808...|[10.5448958386448...|[0.99997367317471...|       0.0|\n|  0.0|(262144,[14,22860...|[12.2738422086206...|[0.99999532764289...|       0.0|\n|  0.0|(262144,[14,27005...|[11.1856777347446...|[0.99998612874169...|       0.0|\n|  0.0|(262144,[14,34140...|[10.3019763119368...|[0.99996643443534...|       0.0|\n|  0.0|(262144,[14,39590...|[10.0864444327247...|[0.99995836153056...|       0.0|\n|  0.0|(262144,[14,46428...|[12.927184268338,...|[0.99999756894855...|       0.0|\n|  0.0|(262144,[14,50134...|[10.2097818492229...|[0.99996319285805...|       0.0|\n|  0.0|(262144,[14,53895...|[11.8294669961711...|[0.99999271340560...|       0.0|\n|  0.0|(262144,[14,66130...|[11.4867181334996...|[0.99998973456774...|       0.0|\n|  0.0|(262144,[14,68867...|[8.96583290750200...|[0.99987231708558...|       0.0|\n|  0.0|(262144,[14,96638...|[10.5143523174589...|[0.99997285667670...|       0.0|\n|  0.0|(262144,[14,96775...|[10.3984499838753...|[0.99996952123855...|       0.0|\n|  0.0|(262144,[14,22239...|[10.9425673338247...|[0.99998231130853...|       0.0|\n|  0.0|(262144,[15,2437,...|[10.9088490199470...|[0.99998170471744...|       0.0|\n|  0.0|(262144,[159,1092...|[5.76198390779860...|[0.99686499289744...|       0.0|\n|  0.0|(262144,[191,7110...|[10.8337753265795...|[0.99998027837973...|       0.0|\n|  0.0|(262144,[212,3722...|[9.66313482116412...|[0.99993641916083...|       0.0|\n|  0.0|(262144,[329,2187...|[2.56349384286269...|[0.92847482909690...|       0.0|\n|  0.0|(262144,[329,2466...|[10.1335467158172...|[0.99996027724812...|       0.0|\n|  0.0|(262144,[329,2994...|[9.54341843741176...|[0.99992833371228...|       0.0|\n|  0.0|(262144,[460,6959...|[10.1392587380203...|[0.99996050348964...|       0.0|\n|  0.0|(262144,[475,1138...|[11.0169196776810...|[0.99998357877904...|       0.0|\n|  0.0|(262144,[511,1450...|[12.2368674530910...|[0.99999515165089...|       0.0|\n|  0.0|(262144,[571,5173...|[9.98351780077976...|[0.99995384770892...|       0.0|\n|  0.0|(262144,[739,9726...|[10.6007892697740...|[0.99997510426777...|       0.0|\n|  0.0|(262144,[991,6194...|[12.3071740950122...|[0.99999548081375...|       0.0|\n|  0.0|(262144,[991,2660...|[10.4970175597818...|[0.99997238206501...|       0.0|\n|  0.0|(262144,[991,3500...|[11.8141094771009...|[0.99999260063873...|       0.0|\n|  0.0|(262144,[991,5286...|[10.6823413077106...|[0.99997705393862...|       0.0|\n|  0.0|(262144,[991,6872...|[11.0666060428419...|[0.99998437473915...|       0.0|\n|  0.0|(262144,[1176,392...|[12.0979247024480...|[0.99999442896817...|       0.0|\n|  0.0|(262144,[1176,353...|[10.3278818935103...|[0.99996729277646...|       0.0|\n|  0.0|(262144,[1212,613...|[10.4140107591245...|[0.99996999182663...|       0.0|\n|  0.0|(262144,[1212,813...|[11.9487055473972...|[0.99999353244238...|       0.0|\n|  0.0|(262144,[1212,114...|[11.0910948016424...|[0.99998475272941...|       0.0|\n|  0.0|(262144,[1322,864...|[10.4411175084884...|[0.99997079430152...|       0.0|\n|  0.0|(262144,[1706,556...|[10.8872061217628...|[0.99998130444602...|       0.0|\n|  0.0|(262144,[1922,663...|[10.0967830753032...|[0.99995878978050...|       0.0|\n|  0.0|(262144,[1998,956...|[12.3100393545420...|[0.99999549374380...|       0.0|\n|  0.0|(262144,[1998,137...|[10.8343099547060...|[0.99998028892043...|       0.0|\n|  0.0|(262144,[1998,340...|[11.0062974640780...|[0.99998340342253...|       0.0|\n|  0.0|(262144,[1998,343...|[11.8582766281712...|[0.99999292033316...|       0.0|\n|  0.0|(262144,[1998,418...|[10.3626448423333...|[0.99996841020500...|       0.0|\n|  0.0|(262144,[2089,795...|[6.89451378345785...|[0.99898769624494...|       0.0|\n|  0.0|(262144,[2089,104...|[7.11176646980150...|[0.99918521117664...|       0.0|\n|  0.0|(262144,[2089,139...|[11.1882904268076...|[0.99998616493521...|       0.0|\n|  0.0|(262144,[2089,493...|[10.2412083555295...|[0.99996433155039...|       0.0|\n|  0.0|(262144,[2089,687...|[9.30484632114027...|[0.99990902604482...|       0.0|\n|  0.0|(262144,[2104,112...|[9.02696654109782...|[0.99987988808925...|       0.0|\n|  0.0|(262144,[2149,815...|[6.22018003687943...|[0.99801506070817...|       0.0|\n|  0.0|(262144,[2149,815...|[6.22018003687943...|[0.99801506070817...|       0.0|\n|  0.0|(262144,[2149,815...|[6.22018003687943...|[0.99801506070817...|       0.0|\n|  0.0|(262144,[2325,238...|[10.9429434175187...|[0.99998231795959...|       0.0|\n|  0.0|(262144,[2424,343...|[10.4802407334384...|[0.99997191482831...|       0.0|\n|  0.0|(262144,[2437,988...|[11.0548172766934...|[0.99998418944949...|       0.0|\n|  0.0|(262144,[2437,133...|[10.7952096132084...|[0.99997950296077...|       0.0|\n|  0.0|(262144,[2513,143...|[10.3983113552732...|[0.99996951701316...|       0.0|\n|  0.0|(262144,[2548,538...|[11.2086742429287...|[0.99998644408804...|       0.0|\n|  0.0|(262144,[2559,259...|[11.8646582713184...|[0.99999296536889...|       0.0|\n|  0.0|(262144,[2559,259...|[10.9773783769885...|[0.99998291646562...|       0.0|\n|  0.0|(262144,[2618,129...|[11.1456273840221...|[0.99998556192613...|       0.0|\n|  0.0|(262144,[2710,107...|[10.1038700290316...|[0.99995908079106...|       0.0|\n|  0.0|(262144,[2731,437...|[10.1507390385311...|[0.99996095431101...|       0.0|\n|  0.0|(262144,[2959,309...|[11.5789072074373...|[0.99999063860807...|       0.0|\n|  0.0|(262144,[2959,770...|[10.5418581275808...|[0.99997359308195...|       0.0|\n|  0.0|(262144,[3177,698...|[12.4651788770040...|[0.99999614130971...|       0.0|\n|  0.0|(262144,[3248,627...|[10.6608345865980...|[0.99997655511080...|       0.0|\n|  0.0|(262144,[3248,211...|[10.8385496666187...|[0.99998037231119...|       0.0|\n|  0.0|(262144,[3283,912...|[10.9110175675300...|[0.99998174434792...|       0.0|\n|  0.0|(262144,[3283,139...|[10.0340901978210...|[0.99995612360470...|       0.0|\n|  0.0|(262144,[3283,164...|[9.88625335100381...|[0.99994913340918...|       0.0|\n|  0.0|(262144,[3294,336...|[9.21522534339001...|[0.99990049720772...|       0.0|\n|  0.0|(262144,[3493,293...|[5.76318791363406...|[0.99686875338091...|       0.0|\n|  0.0|(262144,[3493,314...|[11.4562801415500...|[0.99998941730802...|       0.0|\n|  0.0|(262144,[3527,538...|[6.36493432903807...|[0.99828210178695...|       0.0|\n|  0.0|(262144,[3530,259...|[10.5606770480227...|[0.99997408537205...|       0.0|\n|  0.0|(262144,[3530,398...|[11.1577682035726...|[0.99998573615390...|       0.0|\n|  0.0|(262144,[3530,783...|[10.9704035557878...|[0.99998279689658...|       0.0|\n|  0.0|(262144,[3530,999...|[9.59576248078187...|[0.99993198827864...|       0.0|\n|  0.0|(262144,[3611,172...|[10.4087512656199...|[0.99996983358783...|       0.0|\n|  0.0|(262144,[3611,309...|[10.9889371923853...|[0.99998311279088...|       0.0|\n|  0.0|(262144,[3726,102...|[10.4827295795414...|[0.99997198463911...|       0.0|\n|  0.0|(262144,[3726,286...|[10.7016217806442...|[0.99997749210201...|       0.0|\n|  0.0|(262144,[3726,421...|[9.69817046611345...|[0.99993860805129...|       0.0|\n|  0.0|(262144,[3763,584...|[8.18033407574322...|[0.99971997009162...|       0.0|\n|  0.0|(262144,[3782,641...|[11.6199994517943...|[0.99999101548875...|       0.0|\n|  0.0|(262144,[3875,139...|[10.7163557210079...|[0.99997782129358...|       0.0|\n|  0.0|(262144,[3924,139...|[10.7932500161292...|[0.99997946275628...|       0.0|\n|  0.0|(262144,[3924,172...|[10.2423403742676...|[0.99996437190346...|       0.0|\n|  0.0|(262144,[3924,465...|[12.0394666667376...|[0.99999409359128...|       0.0|\n|  0.0|(262144,[4200,538...|[10.1344120552310...|[0.99996031160555...|       0.0|\n+-----+--------------------+--------------------+--------------------+----------+\nonly showing top 100 rows\n\n\nevaluator: org.apache.spark.ml.evaluation.BinaryClassificationEvaluator = binEval_f13e721c0cb2\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492969909659_-1958544776","id":"20170423-105149_648275248","dateCreated":"2017-04-23T10:51:49-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6147","text":"    val accuracy = evaluator.evaluate(predict)\n    println(\"Accuracy = \" + accuracy*100 + \"%\")","dateUpdated":"2017-04-23T10:54:09-0700","dateFinished":"2017-04-23T10:54:12-0700","dateStarted":"2017-04-23T10:54:09-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\naccuracy: Double = 0.9044943820224719\nAccuracy = 90.4494382022472%\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492970049763_-1991600889","id":"20170423-105409_1603249753","dateCreated":"2017-04-23T10:54:09-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6234","text":"    // compute confusion matrix\n    val predictionsAndLabels = predict.select(\"prediction\", \"label\")\n      .map(row => (row.getDouble(0), row.getDouble(1)))\n\n    val metrics = new MulticlassMetrics(predictionsAndLabels.rdd)\n    println(\"\\nConfusion matrix:\")\n    println(metrics.confusionMatrix)","dateUpdated":"2017-04-23T11:04:55-0700","dateFinished":"2017-04-23T11:04:59-0700","dateStarted":"2017-04-23T11:04:55-0700","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\npredictionsAndLabels: org.apache.spark.sql.Dataset[(Double, Double)] = [_1: double, _2: double]\n\nmetrics: org.apache.spark.mllib.evaluation.MulticlassMetrics = org.apache.spark.mllib.evaluation.MulticlassMetrics@25e34d8c\n\nConfusion matrix:\n1247.0  0.0    \n34.0    144.0  \n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1492970695381_479927522","id":"20170423-110455_673038685","dateCreated":"2017-04-23T11:04:55-0700","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6324"}],"name":"SpamFilteringNotebook","id":"2CEV3J75V","angularObjects":{"2CCFX449A:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}